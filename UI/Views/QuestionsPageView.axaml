<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="clr-namespace:UI.ViewModels"
             xmlns:questions="clr-namespace:UI.ViewModels.Questions"
             xmlns:actipro="http://schemas.actiprosoftware.com/avaloniaui"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="UI.Views.QuestionsPageView"
             x:DataType="viewModels:QuestionsPageViewModel">
    
    <Design.DataContext>
        <!-- This only sets the DataContext for the previewer in an IDE,
             to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
        <viewModels:QuestionsPageViewModel/>
    </Design.DataContext>
    
    <StackPanel>
        <Border Margin="10, 0, 10, 0"
                BorderThickness="1"
                CornerRadius="2"
                Background="{actipro:ThemeResource Container1BackgroundBrush}"
                BorderBrush="{actipro:ThemeResource Container1BorderBrush}"
                BoxShadow="2 2 2 0 LightGray">
            <StackPanel x:Name="Toolbar" Orientation="Horizontal">
                <StackPanel.Styles>
                    <Style Selector="Button.toolbar-base-btn">
                        <Setter Property="Margin" Value="5, 5, 0, 5"></Setter>
                        <Setter Property="Width" Value="30"></Setter>
                        <Setter Property="Height" Value="30"></Setter>
                    </Style>
                    <Style Selector="Button.toolbar-base-btn:pointerover /template/ ContentPresenter">
                        <Setter Property="Background" Value="{actipro:ThemeResource Container4BackgroundBrush}"></Setter>
                        <Setter Property="BorderBrush" Value="{actipro:ThemeResource Container4BorderBrush}"></Setter>
                    </Style>
                    <Style Selector="Button.toolbar-base-btn > PathIcon">
                        <Setter Property="Foreground" Value="{actipro:ThemeResource DefaultForegroundBrushSecondary}"></Setter>
                        <Setter Property="Width" Value="18"/>
                        <Setter Property="Height" Value="18"/>
                    </Style>
                    <Style Selector="Button.toolbar-base-btn:disabled > PathIcon">
                        <Setter Property="Foreground" Value="{actipro:ThemeResource DefaultForegroundBrushDisabled}"></Setter>
                    </Style>
                </StackPanel.Styles>
            
                <StackPanel Orientation="Horizontal">
                    <Button Classes="toolbar-base-btn theme-subtle">
                        <PathIcon Data="{StaticResource add_regular}"/>
                    </Button>
                    <Button Classes="toolbar-base-btn theme-subtle">
                        <PathIcon Data="{StaticResource remove_regular}"/>
                    </Button>
                </StackPanel>
                
                <Panel Margin="10, 0, 10, 0" Width="1" Height="18" Background="{actipro:ThemeResource Container3BorderBrush}"/>
                
                <StackPanel Orientation="Horizontal">
                    <Button Classes="toolbar-base-btn theme-subtle" Command="{Binding SaveSelectionCommand}">
                        <PathIcon Data="{StaticResource save_regular}"/>
                    </Button>
                    <Button Classes="toolbar-base-btn theme-subtle" Command="{Binding DeleteSelectionCommand}">
                        <PathIcon Data="{StaticResource delete_regular}"/>
                    </Button>
                    <Button Classes="toolbar-base-btn theme-subtle" Command="{Binding EditQuestionCommand}">
                        <PathIcon Data="{StaticResource edit_regular}"/>
                    </Button>
                </StackPanel>
            </StackPanel>
        </Border>
        
        <ListBox x:Name="QuestionsList" 
                 ItemsSource="{Binding Questions}" 
                 SelectionMode="Multiple, Toggle" 
                 SelectionChanged="OnSelectionChanged"
                 Margin="20"
                 CornerRadius="3">
                <ListBox.Styles>
                    <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
                        <Setter Property="Background" Value="Transparent"></Setter>
                    </Style>
                    <Style Selector="ListBoxItem:pressed /template/ ContentPresenter">
                        <Setter Property="Background" Value="Transparent"></Setter>
                    </Style>
                </ListBox.Styles>
                
                <ListBox.ItemTemplate>
                    <DataTemplate DataType="{x:Type questions:SingleQuestionViewModel}">
                        <Grid Name="{Binding}" ColumnDefinitions=".3*, .5*, 1.6*, .5*" RowDefinitions="Auto">
                            <CheckBox Classes="theme-solid accent" Grid.Column="0" Margin="20, 0, 0, 0" IsChecked="{Binding $parent[ListBoxItem].IsSelected}"/>
                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Svg  Width="10" Height="10" Path="avares://Assets/docx.svg"/>
                                <TextBlock VerticalAlignment="Center" TextWrapping="Wrap" Text="{Binding Name}"/>
                            </StackPanel>
                            <TextBlock Grid.Column="2" VerticalAlignment="Center" 
                                       TextWrapping="Wrap"
                                       Text="{Binding Description}"/>
                            <StackPanel Grid.Column="3" VerticalAlignment="Center" Orientation="Horizontal">
                                <Button Classes="theme-outline" 
                                        Margin="5, 5, 5, 5" 
                                        Padding="5, 5, 5, 5"
                                        Command="{Binding UploadFiles}">
                                    <PathIcon Width="15" Height="15" Data="{StaticResource upload_regular}"/>
                                </Button>
                                <TextBlock VerticalAlignment="Center" 
                                           Margin="0, 0, 10, 0" 
                                           Text="{Binding FileCount}" />
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
    </StackPanel>
    
</UserControl>
